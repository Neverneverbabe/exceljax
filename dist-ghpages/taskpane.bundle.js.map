{"version":3,"file":"taskpane.bundle.js","mappings":"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","sources":["webpack://exceljax/./src/taskpane/taskpane.js"],"sourcesContent":["/* global document, fetch, console, LM_API_URL */\nconst DEFAULT_LM_API_URL = \"http://localhost:1234/v1/models\";\n// LM_API_URL is replaced at build time via Webpack's DefinePlugin.\nconst MODELS_URL =\n  typeof LM_API_URL !== \"undefined\" ? LM_API_URL : DEFAULT_LM_API_URL;\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const modelDropdown = document.getElementById(\"modelDropdown\");\n  const modelError = document.getElementById(\"modelError\");\n  const modelSpinner = document.getElementById(\"spinner\");\n\n  const RETRY_DELAY_MS = 5000;\n  let retryTimeout = null;\n\n  async function loadModels() {\n    // clear any pending retry since we're attempting a fetch now\n    if (retryTimeout) {\n      clearTimeout(retryTimeout);\n      retryTimeout = null;\n    }\n\n    modelSpinner.style.display = \"inline-block\";\n    modelError.textContent = \"\";\n    modelDropdown.disabled = true;\n\n    try {\n      const res = await fetch(MODELS_URL);\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\n      const data = await res.json();\n      if (!Array.isArray(data.models))\n        throw new Error(\"Unexpected model response\");\n\n      modelDropdown.innerHTML = \"\";\n      data.models.forEach((model) => {\n        const opt = document.createElement(\"option\");\n        opt.value = model.id;\n        opt.textContent = model.id;\n        modelDropdown.appendChild(opt);\n      });\n\n      modelDropdown.disabled = false;\n      modelSpinner.style.display = \"none\";\n    } catch (err) {\n      console.error(err);\n      modelDropdown.innerHTML = `<option disabled>Error loading models</option>`;\n      modelError.textContent =\n        \"LM Studio is not running. Retrying connection...\";\n      modelDropdown.disabled = true;\n\n      // schedule another attempt to fetch models\n      retryTimeout = setTimeout(loadModels, RETRY_DELAY_MS);\n    }\n  }\n\n  loadModels();\n});\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","enumerable","configurable","writable","_invoke","asyncGeneratorStep","Promise","resolve","then","MODELS_URL","LM_API_URL","document","addEventListener","modelDropdown","getElementById","modelError","modelSpinner","retryTimeout","loadModels","_loadModels","apply","arguments","_callee","res","data","_t","_context","clearTimeout","style","display","textContent","disabled","fetch","ok","Error","concat","status","json","Array","isArray","models","innerHTML","forEach","model","opt","createElement","id","appendChild","console","error","setTimeout","_next","_throw"],"sourceRoot":""}
