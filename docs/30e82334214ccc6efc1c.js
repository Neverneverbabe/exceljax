/*! For license information please see 30e82334214ccc6efc1c.js.LICENSE.txt */
function _regenerator(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var i=r&&r.prototype instanceof s?r:s,u=Object.create(i.prototype);return _regeneratorDefine2(u,"_invoke",function(n,r,o){var a,s,i,u=0,l=o||[],f=!1,g={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,s=0,i=e,g.n=n,c}};function m(n,r){for(s=n,i=r,t=0;!f&&u&&!o&&t<l.length;t++){var o,a=l[t],m=g.p,p=a[2];n>3?(o=p===r)&&(i=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(s=0,g.v=r,g.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,g.n=p,s=0))}if(o||n>1)return c;throw f=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,p),s=l,i=p;(t=s<2?e:i)||!f;){a||(s?s<3?(s>1&&(g.n=-1),m(s,i)):g.n=i:g.v=i);try{if(u=2,a){if(s||(o="next"),t=a[o]){if(!(t=t.call(a,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((t=(f=g.n<0)?i:n.call(r,g))!==c)break}catch(t){a=e,s=1,i=t}finally{u=1}}return{value:t,done:f}}}(n,o,a),!0),u}var c={};function s(){}function i(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(_regeneratorDefine2(t={},r,(function(){return this})),t),f=u.prototype=s.prototype=Object.create(l);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return i.prototype=u,_regeneratorDefine2(f,"constructor",u),_regeneratorDefine2(u,"constructor",i),i.displayName="GeneratorFunction",_regeneratorDefine2(u,o,"GeneratorFunction"),_regeneratorDefine2(f),_regeneratorDefine2(f,o,"Generator"),_regeneratorDefine2(f,r,(function(){return this})),_regeneratorDefine2(f,"toString",(function(){return"[object Generator]"})),(_regenerator=function(){return{w:a,m:g}})()}function _regeneratorDefine2(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){_regeneratorDefine2(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}},_regeneratorDefine2(e,t,n,r)}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function asyncGeneratorStep(e,t,n,r,o,a,c){try{var s=e[a](c),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){asyncGeneratorStep(a,r,o,c,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,c,s,"throw",e)}c(void 0)}))}}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var statusElem,defaultConfig={endpoint:"http://localhost:1234/v1/chat/completions",model:"meta-llama-3.1-8b-instruct",token:"",maxHistory:10},config=_objectSpread(_objectSpread({},defaultConfig),JSON.parse(localStorage.getItem("llmConfig")||"{}")),conversationHistory=[],dialog=null;function saveConfig(){localStorage.setItem("llmConfig",JSON.stringify(config))}function updateInputsFromConfig(){document.getElementById("endpointInput").value=config.endpoint;var e=document.getElementById("modelSelect");e&&(e.value=config.model);var t=document.getElementById("tokenInput");t&&(t.value=config.token)}function fetchWithRetry(e,t){return _fetchWithRetry.apply(this,arguments)}function _fetchWithRetry(){return _fetchWithRetry=_asyncToGenerator(_regenerator().m((function e(t,n){var r,o,a,c,s=arguments;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:r=s.length>2&&void 0!==s[2]?s[2]:2,o=0;case 1:if(!(o<=r)){e.n=7;break}return e.p=2,e.n=3,fetch(t,n);case 3:if((a=e.v).ok){e.n=4;break}throw new Error("HTTP ".concat(a.status));case 4:return e.a(2,a);case 5:if(e.p=5,c=e.v,o!==r){e.n=6;break}throw c;case 6:o++,e.n=1;break;case 7:return e.a(2)}}),e,null,[[2,5]])}))),_fetchWithRetry.apply(this,arguments)}function sendToLLM(e){return _sendToLLM.apply(this,arguments)}function _sendToLLM(){return(_sendToLLM=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a,c,s,i;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.length>6e3&&(t=t.slice(0,6e3)+"\n[Truncated]"),o={"Content-Type":"application/json"},config.token&&(o.Authorization="Bearer ".concat(config.token)),a={method:"POST",headers:o,body:JSON.stringify({model:config.model,temperature:.7,stream:!1})},e.p=1,e.n=2,fetchWithRetry(config.endpoint,a);case 2:c=e.v,e.n=4;break;case 3:throw e.p=3,i=e.v,console.error("❌ Fetch error:",i),new Error("Failed to reach LLM: ".concat(i.message));case 4:return e.n=5,c.json().catch((function(e){throw console.error("❌ Invalid JSON:",e),e}));case 5:if(s=e.v,null===(n=s.choices)||void 0===n||null===(n=n[0])||void 0===n||!n.text){e.n=6;break}return e.a(2,s.choices[0].text.trim());case 6:if(null===(r=s.choices)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.message)||void 0===r||!r.content){e.n=7;break}return e.a(2,s.choices[0].message.content.trim());case 7:return e.a(2,"⚠ No valid response format found from LLM.");case 8:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function analyzeSelectedCells(){return _analyzeSelectedCells.apply(this,arguments)}function _analyzeSelectedCells(){return _analyzeSelectedCells=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.getSelectedRange()).load("values"),e.n=1,t.sync();case 1:return r=n.values,o="Analyze the following Excel data and provide summaries, patterns, or suggestions:\n\n".concat(JSON.stringify(r)),statusElem.textContent="",e.n=2,sendToLLM(o);case 2:return a=e.v,n.getOffsetRange(r.length+1,0).getCell(0,0).values=[[a]],e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ Error in analyzeSelectedCells:",t),statusElem&&(statusElem.textContent=t.message||"Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),_analyzeSelectedCells.apply(this,arguments)}function chatWithAI(){return _chatWithAI.apply(this,arguments)}function _chatWithAI(){return(_chatWithAI=_asyncToGenerator(_regenerator().m((function e(){var t,n,r,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,t=document.getElementById("promptInput").value.trim()){e.n=1;break}return e.a(2);case 1:return(n=document.getElementById("chatOutput")).textContent="Thinking...",statusElem.textContent="",conversationHistory.push("User: ".concat(t)),conversationHistory.length>2*config.maxHistory&&conversationHistory.splice(0,conversationHistory.length-2*config.maxHistory),e.n=2,sendToLLM(conversationHistory.join("\n"));case 2:r=e.v,conversationHistory.push("Assistant: ".concat(r)),conversationHistory.length>2*config.maxHistory&&conversationHistory.splice(0,conversationHistory.length-2*config.maxHistory),n.textContent=r,e.n=4;break;case 3:e.p=3,o=e.v,console.error("❌ Error in chatWithAI:",o),statusElem&&(statusElem.textContent=o.message||"Error communicating with LLM");case 4:return e.a(2)}}),e,null,[[0,3]])})))).apply(this,arguments)}function analyzeEntireSheet(){return _analyzeEntireSheet.apply(this,arguments)}function _analyzeEntireSheet(){return _analyzeEntireSheet=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a,c;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),(r=n.getUsedRange()).load("values"),e.n=1,t.sync();case 1:return o="Summarize the following worksheet data:\n\n".concat(JSON.stringify(r.values)),statusElem.textContent="",e.n=2,sendToLLM(o);case 2:return a=e.v,(c=t.workbook.worksheets.add("LLM Summary")).getRange("A1").values=[[a]],c.activate(),e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ Error in analyzeEntireSheet:",t),statusElem&&(statusElem.textContent=t.message||"Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),_analyzeEntireSheet.apply(this,arguments)}function suggestFormulaForSelectedCells(){return _suggestFormulaForSelectedCells.apply(this,arguments)}function _suggestFormulaForSelectedCells(){return _suggestFormulaForSelectedCells=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.getSelectedRange()).load("address"),e.n=1,t.sync();case 1:if(r=document.getElementById("promptInput").value.trim()){e.n=2;break}return e.a(2);case 2:return o="Provide an Excel formula only for: ".concat(r),statusElem.textContent="",e.n=3,sendToLLM(o);case 3:return a=e.v,n.formulas=[[a]],e.n=4,t.sync();case 4:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ Error in suggestFormulaForSelectedCells:",t),statusElem&&(statusElem.textContent=t.message||"Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),_suggestFormulaForSelectedCells.apply(this,arguments)}function improveExistingFormula(){return _improveExistingFormula.apply(this,arguments)}function _improveExistingFormula(){return _improveExistingFormula=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a,c,s,i,u,l,f,g;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.getSelectedRange()).load("formulas"),e.n=1,t.sync();case 1:return r=n.formulas,o="Improve or simplify these formulas. Return them in the same order separated by new lines:\n".concat(JSON.stringify(r)),statusElem.textContent="",e.n=2,sendToLLM(o);case 2:if(a=e.v,c=a.split(/\r?\n/).filter((function(e){return e.trim().length>0})),s=r.length,i=r[0].length,c.length===s*i){for(u=[],l=0,f=0;f<s;f++)for(u[f]=[],g=0;g<i;g++)u[f][g]=c[l++]||r[f][g];n.formulas=u}else 1===c.length&&1===s&&1===i&&(n.formulas=[[c[0]]]);return e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ Error in improveExistingFormula:",t),statusElem&&(statusElem.textContent=t.message||"Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),_improveExistingFormula.apply(this,arguments)}function createVisualsBasedOnData(){return _createVisualsBasedOnData.apply(this,arguments)}function _createVisualsBasedOnData(){return _createVisualsBasedOnData=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a,c;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.getSelectedRange()).load(["values","rowCount","columnCount"]),e.n=1,t.sync();case 1:return r="Suggest the best chart type for this data: ".concat(JSON.stringify(n.values)),statusElem.textContent="",e.n=2,sendToLLM(r);case 2:return o=e.v,a="ColumnClustered",(c=o.toLowerCase()).includes("line")?a="Line":c.includes("pie")?a="Pie":c.includes("bar")?a="BarClustered":c.includes("scatter")&&(a="XYScatter"),t.workbook.worksheets.getActiveWorksheet().charts.add(a,n,Excel.ChartSeriesBy.columns).setPosition(n.getOffsetRange(n.rowCount+1,0),n.getOffsetRange(n.rowCount+15,n.columnCount)),e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ Error in createVisualsBasedOnData:",t),statusElem&&(statusElem.textContent=t.message||"Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),_createVisualsBasedOnData.apply(this,arguments)}function createTable(){return _createTable.apply(this,arguments)}function _createTable(){return _createTable=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),(r=n.tables.add("A1:D1",!0)).name="ExpensesTable",r.getHeaderRowRange().values=[["Date","Merchant","Category","Amount"]],r.rows.add(null,[["1/1/2017","The Phone Company","Communications","120"],["1/2/2017","Northwind Electric Cars","Transportation","142.33"],["1/5/2017","Best For You Organics Company","Groceries","27.9"],["1/10/2017","Coho Vineyard","Restaurant","33"],["1/11/2017","Bellows College","Education","350.1"],["1/15/2017","Trey Research","Other","135"],["1/15/2017","Best For You Organics Company","Groceries","97.88"]]),r.columns.getItemAt(3).getRange().numberFormat=[["€#,##0.00"]],r.getRange().format.autofitColumns(),r.getRange().format.autofitRows(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error(t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),_createTable.apply(this,arguments)}function filterTable(){return _filterTable.apply(this,arguments)}function _filterTable(){return _filterTable=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),r=n.tables.getItem("ExpensesTable"),(o=r.columns.getItem("Category")).load("filter"),e.n=1,t.sync();case 1:return o.filter.applyValuesFilter(["Education","Groceries"]),e.n=2,t.sync();case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error(t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),_filterTable.apply(this,arguments)}function sortTable(){return _sortTable.apply(this,arguments)}function _sortTable(){return _sortTable=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),r=n.tables.getItem("ExpensesTable"),o=[{key:1,ascending:!1}],r.sort.apply(o),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error(t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),_sortTable.apply(this,arguments)}function createChart(){return _createChart.apply(this,arguments)}function _createChart(){return _createChart=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),r=n.tables.getItem("ExpensesTable"),o=r.getDataBodyRange(),(a=n.charts.add("ColumnClustered",o,"Auto")).setPosition("A15","F30"),a.title.text="Expenses",a.legend.position="Right",a.legend.format.fill.setSolidColor("white"),a.dataLabels.format.font.size=15,a.dataLabels.format.font.color="black",a.series.getItemAt(0).name="Value in €",e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error(t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),_createChart.apply(this,arguments)}function freezeHeader(){return _freezeHeader.apply(this,arguments)}function _freezeHeader(){return _freezeHeader=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getActiveWorksheet().freezePanes.freezeRows(1),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error(t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),_freezeHeader.apply(this,arguments)}function openDialog(){Office.context.ui.displayDialogAsync("https://localhost:3000/popup.html",{height:45,width:55},(function(e){(dialog=e.value).addEventHandler(Office.EventType.DialogMessageReceived,processMessage)}))}function processMessage(e){document.getElementById("user-name").innerHTML=e.message,dialog.close()}function suggestPivotTable(){return _suggestPivotTable.apply(this,arguments)}function _suggestPivotTable(){return _suggestPivotTable=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.getSelectedRange()).load("values"),e.n=1,t.sync();case 1:return r="Suggest a pivot table layout for the following data:\n\n".concat(JSON.stringify(n.values)),statusElem.textContent="",e.n=2,sendToLLM(r);case 2:return o=e.v,n.getOffsetRange(n.rowCount+1,0).getCell(0,0).values=[[o]],e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ Error in suggestPivotTable:",t),statusElem&&(statusElem.textContent=t.message||"Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),_suggestPivotTable.apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("chatBtn").onclick=chatWithAI,document.getElementById("analyzeSelectionBtn").onclick=analyzeSelectedCells,document.getElementById("analyzeSheetBtn").onclick=analyzeEntireSheet,document.getElementById("suggestFormulaBtn").onclick=suggestFormulaForSelectedCells,document.getElementById("improveFormulaBtn").onclick=improveExistingFormula,document.getElementById("createVisualsBtn").onclick=createVisualsBasedOnData,document.getElementById("create-table").onclick=createTable,document.getElementById("filter-table").onclick=filterTable,document.getElementById("sort-table").onclick=sortTable,document.getElementById("create-chart").onclick=createChart,document.getElementById("freeze-header").onclick=freezeHeader;var t=document.getElementById("pivot-suggestion");t&&(t.onclick=suggestPivotTable),document.getElementById("open-dialog").onclick=openDialog,document.getElementById("saveSettingsBtn").onclick=function(){config.endpoint=document.getElementById("endpointInput").value.trim()||defaultConfig.endpoint;var e=document.getElementById("modelSelect");config.model=e?e.value.trim():defaultConfig.model;var t=document.getElementById("tokenInput");config.token=t?t.value.trim():"",saveConfig()},statusElem=document.getElementById("status"),updateInputsFromConfig()}}));
