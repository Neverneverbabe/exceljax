/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={54611:function(e,t,n){"use strict";e.exports=n.p+"assets/Scott Pope.jpg"},58394:function(e,t,n){"use strict";e.exports=n.p+"cbc095d2b439dc4b33f9.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"30e82334214ccc6efc1c.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,n),c.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function u(e,o,c,a){var u=o&&o.prototype instanceof s?o:s,l=Object.create(u.prototype);return t(l,"_invoke",function(e,t,o){var c,a,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return c=e,a=0,u=n,p.n=t,i}};function m(e,t){for(a=e,u=t,r=0;!f&&s&&!o&&r<l.length;r++){var o,c=l[r],m=p.p,h=c[2];e>3?(o=h===t)&&(u=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=n):c[0]<=m&&((o=e<2&&m<c[1])?(a=0,p.v=t,p.n=c[1]):m<h&&(o=e<3||c[0]>t||t>h)&&(c[4]=e,c[5]=t,p.n=h,a=0))}if(o||e>1)return i;throw f=!0,t}return function(o,l,h){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,h),a=l,u=h;(r=a<2?n:u)||!f;){c||(a?a<3?(a>1&&(p.n=-1),m(a,u)):p.n=u:p.v=u);try{if(s=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=n}else if((r=(f=p.n<0)?u:e.call(t,p))!==i)break}catch(e){c=n,a=1,u=e}finally{s=1}}return{value:r,done:f}}}(e,c,a),!0),l}var i={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][c]?r(r([][c]())):(t(r={},c,(function(){return this})),r),m=f.prototype=s.prototype=Object.create(p);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=f,t(m,"constructor",f),t(f,"constructor",l),l.displayName="GeneratorFunction",t(f,a,"GeneratorFunction"),t(m),t(m,a,"Generator"),t(m,c,(function(){return this})),t(m,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:u,m:h}})()}function t(e,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}t=function(e,n,r,o){if(n)c?c(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r;else{var a=function(n,r){t(e,n,(function(e){return this._invoke(n,r,e)}))};a("next",0),a("throw",1),a("return",2)}},t(e,n,r,o)}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t,n,r,o,c,a){try{var u=e[c](a),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,c){var a=e.apply(t,n);function u(e){r(a,o,c,u,i,"next",e)}function i(e){r(a,o,c,u,i,"throw",e)}u(void 0)}))}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i,s={endpoint:"http://localhost:1234/v1/chat/completions",model:"meta-llama-3.1-8b-instruct",token:"",maxHistory:10},l=a(a({},s),JSON.parse(localStorage.getItem("llmConfig")||"{}")),f=[],p=null;function m(e,t){return h.apply(this,arguments)}function h(){return h=o(e().m((function t(n,r){var o,c,a,u,i=arguments;return e().w((function(e){for(;;)switch(e.n){case 0:o=i.length>2&&void 0!==i[2]?i[2]:2,c=0;case 1:if(!(c<=o)){e.n=7;break}return e.p=2,e.n=3,fetch(n,r);case 3:if((a=e.v).ok){e.n=4;break}throw new Error("HTTP ".concat(a.status));case 4:return e.a(2,a);case 5:if(e.p=5,u=e.v,c!==o){e.n=6;break}throw u;case 6:c++,e.n=1;break;case 7:return e.a(2)}}),t,null,[[2,5]])}))),h.apply(this,arguments)}function y(e){return g.apply(this,arguments)}function g(){return(g=o(e().m((function t(n){var r,o,c,a,u,i,s;return e().w((function(e){for(;;)switch(e.n){case 0:return n.length>6e3&&(n=n.slice(0,6e3)+"\n[Truncated]"),c={"Content-Type":"application/json"},l.token&&(c.Authorization="Bearer ".concat(l.token)),a={method:"POST",headers:c,body:JSON.stringify({model:l.model,temperature:.7,stream:!1})},e.p=1,e.n=2,m(l.endpoint,a);case 2:u=e.v,e.n=4;break;case 3:throw e.p=3,s=e.v,console.error("❌ Fetch error:",s),new Error("Failed to reach LLM: ".concat(s.message));case 4:return e.n=5,u.json().catch((function(e){throw console.error("❌ Invalid JSON:",e),e}));case 5:if(i=e.v,null===(r=i.choices)||void 0===r||null===(r=r[0])||void 0===r||!r.text){e.n=6;break}return e.a(2,i.choices[0].text.trim());case 6:if(null===(o=i.choices)||void 0===o||null===(o=o[0])||void 0===o||null===(o=o.message)||void 0===o||!o.content){e.n=7;break}return e.a(2,i.choices[0].message.content.trim());case 7:return e.a(2,"⚠ No valid response format found from LLM.");case 8:return e.a(2)}}),t,null,[[1,3]])})))).apply(this,arguments)}function d(){return v.apply(this,arguments)}function v(){return v=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c,a;return e().w((function(e){for(;;)switch(e.n){case 0:return(r=n.workbook.getSelectedRange()).load("values"),e.n=1,n.sync();case 1:return o=r.values,c="Analyze the following Excel data and provide summaries, patterns, or suggestions:\n\n".concat(JSON.stringify(o)),i.textContent="",e.n=2,y(c);case 2:return a=e.v,r.getOffsetRange(o.length+1,0).getCell(0,0).values=[[a]],e.n=3,n.sync();case 3:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("❌ Error in analyzeSelectedCells:",n),i&&(i.textContent=n.message||"Error communicating with LLM");case 3:return t.a(2)}}),t,null,[[0,2]])}))),v.apply(this,arguments)}function w(){return b.apply(this,arguments)}function b(){return(b=o(e().m((function t(){var n,r,o,c;return e().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,n=document.getElementById("promptInput").value.trim()){e.n=1;break}return e.a(2);case 1:return(r=document.getElementById("chatOutput")).textContent="Thinking...",i.textContent="",f.push("User: ".concat(n)),f.length>2*l.maxHistory&&f.splice(0,f.length-2*l.maxHistory),e.n=2,y(f.join("\n"));case 2:o=e.v,f.push("Assistant: ".concat(o)),f.length>2*l.maxHistory&&f.splice(0,f.length-2*l.maxHistory),r.textContent=o,e.n=4;break;case 3:e.p=3,c=e.v,console.error("❌ Error in chatWithAI:",c),i&&(i.textContent=c.message||"Error communicating with LLM");case 4:return e.a(2)}}),t,null,[[0,3]])})))).apply(this,arguments)}function k(){return E.apply(this,arguments)}function E(){return E=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c,a,u;return e().w((function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),(o=r.getUsedRange()).load("values"),e.n=1,n.sync();case 1:return c="Summarize the following worksheet data:\n\n".concat(JSON.stringify(o.values)),i.textContent="",e.n=2,y(c);case 2:return a=e.v,(u=n.workbook.worksheets.add("LLM Summary")).getRange("A1").values=[[a]],u.activate(),e.n=3,n.sync();case 3:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("❌ Error in analyzeEntireSheet:",n),i&&(i.textContent=n.message||"Error communicating with LLM");case 3:return t.a(2)}}),t,null,[[0,2]])}))),E.apply(this,arguments)}function x(){return O.apply(this,arguments)}function O(){return O=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c,a;return e().w((function(e){for(;;)switch(e.n){case 0:return(r=n.workbook.getSelectedRange()).load("address"),e.n=1,n.sync();case 1:if(o=document.getElementById("promptInput").value.trim()){e.n=2;break}return e.a(2);case 2:return c="Provide an Excel formula only for: ".concat(o),i.textContent="",e.n=3,y(c);case 3:return a=e.v,r.formulas=[[a]],e.n=4,n.sync();case 4:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("❌ Error in suggestFormulaForSelectedCells:",n),i&&(i.textContent=n.message||"Error communicating with LLM");case 3:return t.a(2)}}),t,null,[[0,2]])}))),O.apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return C=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c,a,u,s,l,f,p,m,h;return e().w((function(e){for(;;)switch(e.n){case 0:return(r=n.workbook.getSelectedRange()).load("formulas"),e.n=1,n.sync();case 1:return o=r.formulas,c="Improve or simplify these formulas. Return them in the same order separated by new lines:\n".concat(JSON.stringify(o)),i.textContent="",e.n=2,y(c);case 2:if(a=e.v,u=a.split(/\r?\n/).filter((function(e){return e.trim().length>0})),s=o.length,l=o[0].length,u.length===s*l){for(f=[],p=0,m=0;m<s;m++)for(f[m]=[],h=0;h<l;h++)f[m][h]=u[p++]||o[m][h];r.formulas=f}else 1===u.length&&1===s&&1===l&&(r.formulas=[[u[0]]]);return e.n=3,n.sync();case 3:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("❌ Error in improveExistingFormula:",n),i&&(i.textContent=n.message||"Error communicating with LLM");case 3:return t.a(2)}}),t,null,[[0,2]])}))),C.apply(this,arguments)}function I(){return B.apply(this,arguments)}function B(){return B=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c,a,u;return e().w((function(e){for(;;)switch(e.n){case 0:return(r=n.workbook.getSelectedRange()).load(["values","rowCount","columnCount"]),e.n=1,n.sync();case 1:return o="Suggest the best chart type for this data: ".concat(JSON.stringify(r.values)),i.textContent="",e.n=2,y(o);case 2:return c=e.v,a="ColumnClustered",(u=c.toLowerCase()).includes("line")?a="Line":u.includes("pie")?a="Pie":u.includes("bar")?a="BarClustered":u.includes("scatter")&&(a="XYScatter"),n.workbook.worksheets.getActiveWorksheet().charts.add(a,r,Excel.ChartSeriesBy.columns).setPosition(r.getOffsetRange(r.rowCount+1,0),r.getOffsetRange(r.rowCount+15,r.columnCount)),e.n=3,n.sync();case 3:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("❌ Error in createVisualsBasedOnData:",n),i&&(i.textContent=n.message||"Error communicating with LLM");case 3:return t.a(2)}}),t,null,[[0,2]])}))),B.apply(this,arguments)}function j(){return P.apply(this,arguments)}function P(){return P=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o;return e().w((function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),(o=r.tables.add("A1:D1",!0)).name="ExpensesTable",o.getHeaderRowRange().values=[["Date","Merchant","Category","Amount"]],o.rows.add(null,[["1/1/2017","The Phone Company","Communications","120"],["1/2/2017","Northwind Electric Cars","Transportation","142.33"],["1/5/2017","Best For You Organics Company","Groceries","27.9"],["1/10/2017","Coho Vineyard","Restaurant","33"],["1/11/2017","Bellows College","Education","350.1"],["1/15/2017","Trey Research","Other","135"],["1/15/2017","Best For You Organics Company","Groceries","97.88"]]),o.columns.getItemAt(3).getRange().numberFormat=[["€#,##0.00"]],o.getRange().format.autofitColumns(),o.getRange().format.autofitRows(),e.n=1,n.sync();case 1:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error(n);case 3:return t.a(2)}}),t,null,[[0,2]])}))),P.apply(this,arguments)}function R(){return L.apply(this,arguments)}function L(){return L=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c;return e().w((function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),o=r.tables.getItem("ExpensesTable"),(c=o.columns.getItem("Category")).load("filter"),e.n=1,n.sync();case 1:return c.filter.applyValuesFilter(["Education","Groceries"]),e.n=2,n.sync();case 2:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error(n);case 3:return t.a(2)}}),t,null,[[0,2]])}))),L.apply(this,arguments)}function T(){return A.apply(this,arguments)}function A(){return A=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c;return e().w((function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),o=r.tables.getItem("ExpensesTable"),c=[{key:1,ascending:!1}],o.sort.apply(c),e.n=1,n.sync();case 1:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error(n);case 3:return t.a(2)}}),t,null,[[0,2]])}))),A.apply(this,arguments)}function F(){return N.apply(this,arguments)}function N(){return N=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c,a;return e().w((function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),o=r.tables.getItem("ExpensesTable"),c=o.getDataBodyRange(),(a=r.charts.add("ColumnClustered",c,"Auto")).setPosition("A15","F30"),a.title.text="Expenses",a.legend.position="Right",a.legend.format.fill.setSolidColor("white"),a.dataLabels.format.font.size=15,a.dataLabels.format.font.color="black",a.series.getItemAt(0).name="Value in €",e.n=1,n.sync();case 1:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error(n);case 3:return t.a(2)}}),t,null,[[0,2]])}))),N.apply(this,arguments)}function M(){return z.apply(this,arguments)}function z(){return z=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){return e().w((function(e){for(;;)switch(e.n){case 0:return n.workbook.worksheets.getActiveWorksheet().freezePanes.freezeRows(1),e.n=1,n.sync();case 1:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error(n);case 3:return t.a(2)}}),t,null,[[0,2]])}))),z.apply(this,arguments)}function D(){Office.context.ui.displayDialogAsync("https://localhost:3000/popup.html",{height:45,width:55},(function(e){(p=e.value).addEventHandler(Office.EventType.DialogMessageReceived,H)}))}function H(e){document.getElementById("user-name").innerHTML=e.message,p.close()}function G(){return J.apply(this,arguments)}function J(){return J=o(e().m((function t(){var n;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=o(e().m((function t(n){var r,o,c;return e().w((function(e){for(;;)switch(e.n){case 0:return(r=n.workbook.getSelectedRange()).load("values"),e.n=1,n.sync();case 1:return o="Suggest a pivot table layout for the following data:\n\n".concat(JSON.stringify(r.values)),i.textContent="",e.n=2,y(o);case 2:return c=e.v,r.getOffsetRange(r.rowCount+1,0).getCell(0,0).values=[[c]],e.n=3,n.sync();case 3:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("❌ Error in suggestPivotTable:",n),i&&(i.textContent=n.message||"Error communicating with LLM");case 3:return t.a(2)}}),t,null,[[0,2]])}))),J.apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("chatBtn").onclick=w,document.getElementById("analyzeSelectionBtn").onclick=d,document.getElementById("analyzeSheetBtn").onclick=k,document.getElementById("suggestFormulaBtn").onclick=x,document.getElementById("improveFormulaBtn").onclick=S,document.getElementById("createVisualsBtn").onclick=I,document.getElementById("create-table").onclick=j,document.getElementById("filter-table").onclick=R,document.getElementById("sort-table").onclick=T,document.getElementById("create-chart").onclick=F,document.getElementById("freeze-header").onclick=M;var t=document.getElementById("pivot-suggestion");t&&(t.onclick=G),document.getElementById("open-dialog").onclick=D,document.getElementById("saveSettingsBtn").onclick=function(){l.endpoint=document.getElementById("endpointInput").value.trim()||s.endpoint;var e=document.getElementById("modelSelect");l.model=e?e.value.trim():s.model;var t=document.getElementById("tokenInput");l.token=t?t.value.trim():"",localStorage.setItem("llmConfig",JSON.stringify(l))},i=document.getElementById("status"),function(){document.getElementById("endpointInput").value=l.endpoint;var e=document.getElementById("modelSelect");e&&(e.value=l.model);var t=document.getElementById("tokenInput");t&&(t.value=l.token)}()}}))}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b),new URL(n(54611),n.b)}()}();
//# sourceMappingURL=taskpane.js.map
