/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var t={54611:function(t,e,n){"use strict";t.exports=n.p+"assets/Scott Pope.jpg"},58394:function(t,e,n){"use strict";t.exports=n.p+"cbc095d2b439dc4b33f9.css"},60947:function(t,e,n){"use strict";t.exports=n.p+"26975ab4fa13e6d1a34d.js"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var c=e[r]={exports:{}};return t[r](c,c.exports,n),c.exports}n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function u(t,o,c,i){var u=o&&o.prototype instanceof s?o:s,l=Object.create(u.prototype);return e(l,"_invoke",function(t,e,o){var c,i,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(t,e){return c=t,i=0,u=n,p.n=e,a}};function m(t,e){for(i=t,u=e,r=0;!f&&s&&!o&&r<l.length;r++){var o,c=l[r],m=p.p,y=c[2];t>3?(o=y===e)&&(u=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=n):c[0]<=m&&((o=t<2&&m<c[1])?(i=0,p.v=e,p.n=c[1]):m<y&&(o=t<3||c[0]>e||e>y)&&(c[4]=t,c[5]=e,p.n=y,i=0))}if(o||t>1)return a;throw f=!0,e}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&m(l,y),i=l,u=y;(r=i<2?n:u)||!f;){c||(i?i<3?(i>1&&(p.n=-1),m(i,u)):p.n=u:p.v=u);try{if(s=2,c){if(i||(o="next"),r=c[o]){if(!(r=r.call(c,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,i<2&&(i=0)}else 1===i&&(r=c.return)&&r.call(c),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=n}else if((r=(f=p.n<0)?u:t.call(e,p))!==a)break}catch(t){c=n,i=1,u=t}finally{s=1}}return{value:r,done:f}}}(t,c,i),!0),l}var a={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][c]?r(r([][c]())):(e(r={},c,(function(){return this})),r),m=f.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,i,"GeneratorFunction")),t.prototype=Object.create(m),t}return l.prototype=f,e(m,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,i,"GeneratorFunction"),e(m),e(m,i,"Generator"),e(m,c,(function(){return this})),e(m,"toString",(function(){return"[object Generator]"})),(t=function(){return{w:u,m:y}})()}function e(t,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}e=function(t,n,r,o){if(n)c?c(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r;else{var i=function(n,r){e(t,n,(function(t){return this._invoke(n,r,t)}))};i("next",0),i("throw",1),i("return",2)}},e(t,n,r,o)}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e,n,r,o,c,i){try{var u=t[c](i),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,c){var i=t.apply(e,n);function u(t){r(i,o,c,u,a,"next",t)}function a(t){r(i,o,c,u,a,"throw",t)}u(void 0)}))}}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,r){return(e=function(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a,s={endpoint:"http://localhost:4321/v1/completions",model:"meta-llama-3.1-8b-instruct"},l=i(i({},s),JSON.parse(localStorage.getItem("llmConfig")||"{}")),f=[];function p(t){return m.apply(this,arguments)}function m(){return(m=o(t().m((function e(n){var r,o,c,i;return t().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch(l.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:l.model,prompt:n,max_tokens:200,temperature:.7})}).catch((function(t){throw console.error("❌ Fetch error:",t),t}));case 1:return c=t.v,t.n=2,c.json().catch((function(t){throw console.error("❌ Invalid JSON:",t),t}));case 2:if(i=t.v,null===(r=i.choices)||void 0===r||null===(r=r[0])||void 0===r||!r.text){t.n=3;break}return t.a(2,i.choices[0].text.trim());case 3:if(null===(o=i.choices)||void 0===o||null===(o=o[0])||void 0===o||null===(o=o.message)||void 0===o||!o.content){t.n=4;break}return t.a(2,i.choices[0].message.content.trim());case 4:return t.a(2,"⚠ No valid response format found from LLM.");case 5:return t.a(2)}}),e)})))).apply(this,arguments)}function y(){return d.apply(this,arguments)}function d(){return d=o(t().m((function e(){var n;return t().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m((function e(n){var r,o,c,i;return t().w((function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.getSelectedRange()).load("values"),t.n=1,n.sync();case 1:return o=r.values,c="Analyze the following Excel data and provide summaries, patterns, or suggestions:\n\n".concat(JSON.stringify(o)),a.textContent="",t.n=2,p(c);case 2:return i=t.v,r.getOffsetRange(o.length+1,0).getCell(0,0).values=[[i]],t.n=3,n.sync();case 3:return t.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("❌ Error in analyzeSelectedCells:",n),a&&(a.textContent="Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),d.apply(this,arguments)}function h(){return g.apply(this,arguments)}function g(){return(g=o(t().m((function e(){var n,r,o,c;return t().w((function(t){for(;;)switch(t.n){case 0:if(t.p=0,n=document.getElementById("promptInput").value.trim()){t.n=1;break}return t.a(2);case 1:return(r=document.getElementById("chatOutput")).textContent="Thinking...",a.textContent="",f.push("User: ".concat(n)),t.n=2,p(f.join("\n"));case 2:o=t.v,f.push("Assistant: ".concat(o)),r.textContent=o,t.n=4;break;case 3:t.p=3,c=t.v,console.error("❌ Error in chatWithAI:",c),a&&(a.textContent="Error communicating with LLM");case 4:return t.a(2)}}),e,null,[[0,3]])})))).apply(this,arguments)}function v(){return b.apply(this,arguments)}function b(){return b=o(t().m((function e(){var n;return t().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m((function e(n){var r,o,c,i,u;return t().w((function(t){for(;;)switch(t.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),(o=r.getUsedRange()).load("values"),t.n=1,n.sync();case 1:return c="Summarize the following worksheet data:\n\n".concat(JSON.stringify(o.values)),a.textContent="",t.n=2,p(c);case 2:return i=t.v,(u=n.workbook.worksheets.add("LLM Summary")).getRange("A1").values=[[i]],u.activate(),t.n=3,n.sync();case 3:return t.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("❌ Error in analyzeEntireSheet:",n),a&&(a.textContent="Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),b.apply(this,arguments)}function w(){return E.apply(this,arguments)}function E(){return E=o(t().m((function e(){var n;return t().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m((function e(n){var r,o,c,i;return t().w((function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.getSelectedRange()).load("address"),t.n=1,n.sync();case 1:if(o=document.getElementById("promptInput").value.trim()){t.n=2;break}return t.a(2);case 2:return c="Provide an Excel formula only for: ".concat(o),a.textContent="",t.n=3,p(c);case 3:return i=t.v,r.formulas=[[i]],t.n=4,n.sync();case 4:return t.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("❌ Error in suggestFormulaForSelectedCells:",n),a&&(a.textContent="Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),E.apply(this,arguments)}function O(){return S.apply(this,arguments)}function S(){return S=o(t().m((function e(){var n;return t().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m((function e(n){var r,o,c,i,u,s,l,f,m,y,d;return t().w((function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.getSelectedRange()).load("formulas"),t.n=1,n.sync();case 1:return o=r.formulas,c="Improve or simplify these formulas. Return them in the same order separated by new lines:\n".concat(JSON.stringify(o)),a.textContent="",t.n=2,p(c);case 2:if(i=t.v,u=i.split(/\r?\n/).filter((function(t){return t.trim().length>0})),s=o.length,l=o[0].length,u.length===s*l){for(f=[],m=0,y=0;y<s;y++)for(f[y]=[],d=0;d<l;d++)f[y][d]=u[m++]||o[y][d];r.formulas=f}else 1===u.length&&1===s&&1===l&&(r.formulas=[[u[0]]]);return t.n=3,n.sync();case 3:return t.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("❌ Error in improveExistingFormula:",n),a&&(a.textContent="Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),S.apply(this,arguments)}function k(){return x.apply(this,arguments)}function x(){return x=o(t().m((function e(){var n;return t().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m((function e(n){var r,o,c,i,u;return t().w((function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.getSelectedRange()).load(["values","rowCount","columnCount"]),t.n=1,n.sync();case 1:return o="Suggest the best chart type for this data: ".concat(JSON.stringify(r.values)),a.textContent="",t.n=2,p(o);case 2:return c=t.v,i="ColumnClustered",(u=c.toLowerCase()).includes("line")?i="Line":u.includes("pie")?i="Pie":u.includes("bar")?i="BarClustered":u.includes("scatter")&&(i="XYScatter"),n.workbook.worksheets.getActiveWorksheet().charts.add(i,r,Excel.ChartSeriesBy.columns).setPosition(r.getOffsetRange(r.rowCount+1,0),r.getOffsetRange(r.rowCount+15,r.columnCount)),t.n=3,n.sync();case 3:return t.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("❌ Error in createVisualsBasedOnData:",n),a&&(a.textContent="Error communicating with LLM");case 3:return e.a(2)}}),e,null,[[0,2]])}))),x.apply(this,arguments)}Office.onReady((function(t){t.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("chatBtn").onclick=h,document.getElementById("analyzeSelectionBtn").onclick=y,document.getElementById("analyzeSheetBtn").onclick=v,document.getElementById("suggestFormulaBtn").onclick=w,document.getElementById("improveFormulaBtn").onclick=O,document.getElementById("createVisualsBtn").onclick=k,document.getElementById("saveSettingsBtn").onclick=function(){l.endpoint=document.getElementById("endpointInput").value.trim()||s.endpoint,l.model=document.getElementById("modelInput").value.trim()||s.model,localStorage.setItem("llmConfig",JSON.stringify(l))},a=document.getElementById("status"),document.getElementById("endpointInput").value=l.endpoint,document.getElementById("modelInput").value=l.model)}))}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b),new URL(n(54611),n.b)}()}();
//# sourceMappingURL=taskpane.js.map
